!function(e){e(document).on("click",".listing-type .action span.edit",(function(){e(this).parents("li").find(".edit-action").slideToggle()})),e("#input-new-type-form").on("submit",(function(a){a.preventDefault();var t=e(this),l=e(t),s=e("#rtcl-add-btn",l),n=e("#add-input-type",l),i=n.val(),r=(e("#_rt_rtcl_disable_price",l).val(),new FormData(this));r.append("action","rtcl_ajax_add_listing_type"),r.append(rtcl.nonceId,rtcl.nonce),l.find(".alert").remove(),i?e.ajax({url:rtcl.ajaxurl,cache:!1,processData:!1,contentType:!1,data:r,dataType:"json",type:"POST",beforeSend:function(){s.addClass("spinner rtcl-loading").prop("disabled",!0),e("#rtcl-listing-type-wrap").find(".rtcl-message").remove()},success:function(a){a.success&&(n.val(""),function(a){var t=function(e){var a='<li class="rtcl-list-group-item listing-type" data-id="'+e.id+'"><div class="type-details d-flex"><div class="type-info"><div class="type-info-id">'+e.id+'</div><div class="type-info-name">'+e.name+'</div></div><div class="action ml-auto"><span class="rtcl-btn edit">Edit</span><span class="rtcl-btn rtcl-btn-danger delete">Delete</span></div></div><div class="edit-action"><form class="rtcl-row input-update-type-form"><div class="rtcl-form-group rtcl-col-6"><label class="rtcl-field-label">ID</label><input type="text" name="id" class="rtcl-form-control" value="'+e.id+'" ></div><div class="rtcl-form-group rtcl-col-6"><label class="rtcl-field-label">Type</label><input type="text" name="name" class="rtcl-form-control" value="'+e.name+'" ></div><div class="rtcl-form-group rtcl-col-12"><button class="rtcl-btn">Update</button></div></form></div></div></li>';return a}(a),l=e("#rtcl-listing-type-wrap"),s=e(l,"#listing-types");s.length||(s=e("<ul id='listing-types' class='list-group' />"),l.html(s));s.append(t)}(a.data));var t=a.success?"alert-success":"alert-danger",i=e('<div class="col-12 alert alert-dismissible fade show" role="alert" />').append(a.message);i.addClass(t),l.append(i),s.removeClass("spinner rtcl-loading").prop("disabled",!1)},error:function(a){e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Server Error !!!").appendTo(l),s.removeClass("spinner rtcl-loading").prop("disabled",!1)}}):(e('<div class="alert alert-danger alert-dismissible fade show" role="alert" />').append("Please fill type.").appendTo(l),n.focus())})),e(document).on("submit",".input-update-type-form",(function(a){a.preventDefault();var t=e(this),l=t.closest("li"),s=l.data("id")||"",n=e(".type-info-id",l),i=e(".type-info-name",l),r=t.find("button[type=submit]"),d=t.find("input[name=id]"),c=d.val()||"",o=t.find("input[name=name]"),p=o.val()||"",u=new FormData(this);u.append("action","rtcl_ajax_update_listing_type"),u.append("old_id",s),u.append(rtcl.nonceId,rtcl.nonce),t.find(".alert").remove(),c&&p&&s?e.ajax({url:rtcl.ajaxurl,cache:!1,processData:!1,contentType:!1,data:u,dataType:"json",type:"POST",beforeSend:function(){r.addClass("spinner rtcl-loading").prop("disabled",!0),t.find(".alert").remove(),e("#rtcl-listing-type-wrap").find(".rtcl-message").remove()},success:function(a){d.val(a.data.id),o.val(a.data.name),a.success&&(n.text(a.data.id),i.text(a.data.name),l.data("id",a.data.id)),r.removeClass("spinner rtcl-loading").prop("disabled",!1);var s=a.success?"alert-success":"alert-danger",c=e('<div class="col-12 alert alert-dismissible fade show" role="alert" />').append(a.message);c.addClass(s),t.append(c)},error:function(a){console.log(a),e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Server Error !!!").appendTo(t),r.removeClass("spinner rtcl-loading").prop("disabled",!1)}}):e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Please fill id and type.").appendTo(t)})),e(document).on("click",".listing-type .action span.delete:not(.disabled)",(function(){if(confirm("Are you sure to delete this type?")){var a=e(this),t=a.parents("li.listing-type"),l=t.data("id");if(l){var s={action:"rtcl_ajax_delete_listing_type",id:l};s[rtcl.nonceId]=rtcl.nonce,e.ajax({url:rtcl.ajaxurl,data:s,type:"POST",beforeSend:function(){a.addClass("spinner rtcl-loading disabled").prop("disabled",!1)},success:function(l){l.success?t.slideUp("slow",(function(){e(this).remove()})):(a.removeClass("spinner rtcl-loading disabled").prop("disabled",!1),alert(l.message))},error:function(e){a.removeClass("spinner rtcl-loading disabled").prop("disabled",!1),console.log(e)}})}else alert("Type id is required.")}})),e(document).ready((function(){var a=e("#rtcl-listing-type-wrap");a.find("#listing-types").sortable({cursor:"ns-resize",axis:"y",forcePlaceholderSize:!0,tolerance:"pointer",start:function(e,a){a.placeholder.height(a.item.height()+30)},update:function(t,l){var s=a.find("#listing-types > li"),n={};s.each((function(){var a=e(this),t=a.find('input[name="id"]').val(),l=a.find('input[name="name"]').val();t&&(n[t]=l)}));var i={action:"rtcl_ajax_sort_ad_types",types:n};i[rtcl.nonceId]=rtcl.nonce,e.ajax({url:rtcl.ajaxurl,data:i,type:"POST",beforeSend:function(){a.find(".rtcl-message").remove()},success:function(t){var l=e('<div class="rtcl-message alert"></div>'),s=t.success?"alert-success":"alert-danger";l.addClass(s).text(t.message).appendTo(a)},error:function(e){console.log(e.responseText)}})}})}))}(jQuery);
