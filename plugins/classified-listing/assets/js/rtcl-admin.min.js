!function(t){t.fn.getType=function(){return"INPUT"==this[0].tagName?this[0].type.toLowerCase():this[0].tagName.toLowerCase()};var e='<div class="rtcl-spinner block"><span class="rtcl-icon-spinner animate-spin"></span></div>';t(document.body).on("rtcl_add_error_tip",(function(e,r,i){var n=r.position();0===r.parent().find(".rtcl_error_tip").length&&(r.after('<div class="rtcl_error_tip '+i+'">'+rtcl[i]+"</div>"),r.parent().find(".rtcl_error_tip").css("left",n.left+r.width()-r.width()/2-t(".rtcl_error_tip").width()/2).css("top",n.top+r.height()).fadeIn("100"))})).on("rtcl_remove_error_tip",(function(e,r,i){r.parent().find(".rtcl_error_tip."+i).fadeOut("100",(function(){t(this).remove()}))})).on("click",(function(){t(".rtcl_error_tip").fadeOut("100",(function(){t(this).remove()}))})).on("blur","#rtcl-price[type=text],#rtcl-pricing-price[type=text], input.rtcl-price",(function(){t(".rtcl_error_tip").fadeOut("100",(function(){t(this).remove()}))})).on("keyup","#rtcl-price[type=text], #rtcl-pricing-price[type=text], input.rtcl-price",(function(){var e=t(this).attr("id"),r=rtcl.decimal_point,i="i18n_mon_decimal_error";"rtcl-pricing-price"===e&&(r=rtcl.pricing_decimal_point,i="i18n_mon_pricing_decimal_error");var n=new RegExp("[^-0-9%\\"+r+"]+","gi"),a=t(this).val(),c=a.replace(n,"");a!==c?t(document.body).triggerHandler("rtcl_add_error_tip",[t(this),i]):t(document.body).triggerHandler("rtcl_remove_error_tip",[t(this),i])})).on("change","#rtcl-price[type=text],#rtcl-pricing-price[type=text], input.rtcl-price",(function(){var e="rtcl-pricing-price"===t(this).attr("id")?rtcl.pricing_decimal_point:rtcl.decimal_point,r=new RegExp("[^-0-9%\\"+e+"]+","gi"),i=t(this).val(),n=i.replace(r,"");i!==n&&t(this).val(n)})).on("rtcl_price_type_changed",(function(e,r){"on_call"===r.value||"free"===r.value||"no_price"===r.value?t("#rtcl-price").attr("required","false").val(""):t("#rtcl-price").attr("required","true"),t("#rtcl-price-items").removeClass((function(t,e){return(e.match(/(^|\s)rtcl-price-type\S+/g)||[]).join(" ")})).addClass("rtcl-price-type-"+r.value)})).on("rtcl_listing_pricing_type_changed",(function(e,r){t("#rtcl-pricing-items").removeClass().addClass("rtcl-pricing-"+r.value)})).on("change","#rtcl-price-type",(function(){t(document.body).trigger("rtcl_price_type_changed",[this])})).on("change","input[name=_rtcl_listing_pricing]",(function(){t(document.body).trigger("rtcl_listing_pricing_type_changed",[this])}));var r=function(e){this._target=e,this.timestampdiv=t(".rtcl-timestamp-div",this._target),this.timestamp=t(".rtcl-timestamp",this._target),this.stamp=this.timestamp.html(),this.timestampwrap=this.timestampdiv.find(".timestamp-wrap"),this.edittimestamp=this.timestampdiv.siblings("a.edit-timestamp"),this.init=function(){var e=this;this.edittimestamp.on("click",(function(r){e.timestampdiv.is(":hidden")&&(e.timestampdiv.slideDown("fast",(function(){t("input, select",e.timestampwrap).first().focus()})),t(this).hide()),r.preventDefault()})),this.timestampdiv.find(".cancel-timestamp").on("click",(function(t){e.edittimestamp.show().focus(),e.timestampdiv.slideUp("fast"),e.timestampdiv.find(".rtcl-mm").val(e.timestampdiv.find(".rtcl-hidden_mm").val()),e.timestampdiv.find(".rtcl-jj").val(e.timestampdiv.find(".rtcl-hidden_jj").val()),e.timestampdiv.find(".rtcl-aa").val(e.timestampdiv.find(".rtcl-hidden_aa").val()),e.timestampdiv.find(".rtcl-hh").val(e.timestampdiv.find(".rtcl-hidden_hh").val()),e.timestampdiv.find(".rtcl-mn").val(e.timestampdiv.find(".rtcl-hidden_mn").val()),e.timestamp.html(e.stamp),t.preventDefault()})),this.timestampdiv.find(".save-timestamp").on("click",(function(r){var i=e.timestampdiv.find(".rtcl-aa").val(),n=e.timestampdiv.find(".rtcl-mm").val(),a=e.timestampdiv.find(".rtcl-jj").val(),c=e.timestampdiv.find(".rtcl-hh").val(),l=e.timestampdiv.find(".rtcl-mn").val(),o=new Date(i,n-1,a,c,l);r.preventDefault(),o.getFullYear()==i&&1+o.getMonth()==n&&o.getDate()==a&&o.getMinutes()==l?(e.timestampwrap.removeClass("form-invalid"),e.timestamp.html(rtcl.expiredOn+" <b>"+rtcl.dateFormat.replace("%1$s",t('option[value="'+n+'"]',"#mm").attr("data-text")).replace("%2$s",parseInt(a,10)).replace("%3$s",i).replace("%4$s",("00"+c).slice(-2)).replace("%5$s",("00"+l).slice(-2))+"</b> "),e.edittimestamp.show().focus(),e.timestampdiv.slideUp("fast")):e.timestampwrap.addClass("form-invalid")}))},this.init()};t.fn.rtcl_time_stamp=function(){t(this).each((function(){return new r(t(this))}))},t(".rtcl-timestamp-wrapper").rtcl_time_stamp(),t(".misc-pub-rtcl-never-expires").on("click","input",(function(){t(this).is(":checked")?t(".misc-pub-rtcl-expiration-time").hide():t(".misc-pub-rtcl-expiration-time").show()})),t("#rtcl-ad-type").on("change",(function(){var r=t(this),i=r.val(),n=t("#rtcl-category-wrap"),a=t("#rtcl-price-items"),c=t('<select class="form-control" id="rtcl-category-of-type" name="rtcl-category-of-type" required />');if(a.find(".price-label .rtcl-per-unit").remove(),"to_let"===i){var l=a.find("label").attr("data-per-unit");a.find(".price-label").append('<span class="rtcl-per-unit"> / '+l+"</span>")}if(""===i?t("#rtcl-pricing-wrap").slideUp(250):t("#rtcl-pricing-wrap").slideDown(250),i){var o={action:"rtcl_get_one_level_category_select_list_by_type",type:i,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({url:rtcl.ajaxurl,data:o,type:"POST",beforeSend:function(){t(e).insertAfter(r),t("#rtcl-custom-fields-list").html(""),n.html(c)},success:function(t){r.next(".rtcl-spinner").remove(),t.success&&n.html(c.append(t.cats))},error:function(t){r.next(".rtcl-spinner").remove(),console.log(t.responseText)}})}else t("#rtcl-custom-fields-list").html(""),n.html(c)})),t(document).on("change","#rtcl-category-wrap select",(function(){var r=t(this),i=r.parents("#rtcl-category-wrap"),n=t("#rtcl-category-input"),a=t("#rtcl-custom-fields-list"),c=t(this).val(),l=t("<div class='alert rtcl-response'></div>"),o={action:"rtcl_custom_fields_listings",post_id:t("#rtcl-custom-fields-list").data("post_id"),term_id:c,is_admin:rtcl.is_admin,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};c?(n.val(c),t.ajax({url:rtcl.ajaxurl,data:o,type:"POST",dataType:"json",beforeSend:function(){t(e).insertAfter(r),i.find(".alert.rtcl-response").remove(),r.nextAll("select").remove()},success:function(e){i.find(".rtcl-spinner").remove(),e.child_cats&&i.append(t('<select class="rtcl-form-control" id="rtcl-category-of-'+c+'" name="rtcl-category-of-'+c+'" required />').append(e.child_cats)),a.html(e.custom_fields),rtclInitDateField(),rtclRenderCFfConditions()},error:function(t){i.find(".rtcl-spinner").remove(),l.removeClass("alert-success").addClass("alert-danger").html(t.responseText).appendTo(i)}})):r.nextAll("select").remove(),function(e){var r=t("#rtcl-price-items"),i=t("#rtcl-price-unit-wrap",r),n=i.length,a={__rtcl_wpnonce:rtcl.__rtcl_wpnonce,action:"rtcl_get_price_units_ajax",term_id:e||0};t.ajax({url:ajaxurl,data:a,type:"POST",dataType:"json",beforeSend:function(){},success:function(t){t.html?(n&&i.remove(),r.append(t.html)):i.remove()},error:function(){}})}(c)})),t("#rtcl-export-cat-loc-json").on("click",(function(e){e.preventDefault();var r=t(this),i=r.closest(".rtcl-export-group"),n=document.createElement("a"),a={action:"rtcl_taxonomy_settings_export",__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({type:"POST",url:rtcl.ajaxurl,data:a,beforeSend:function(){t(".rtcl-flash-messages").remove(),r.addClass("disabled").attr("disabled","disabled"),t('<span class="rtcl-icon-spinner animate-spin"></span>').insertAfter(r)},success:function(e){i.find(".rtcl-icon-spinner").remove(),n.href=e.data.path,n.download=e.data.path.split("/").pop(),document.body.appendChild(n),n.click(),document.body.removeChild(n),function(e){var r={action:"rtcl_remove_temporary_file",__rtcl_wpnonce:rtcl.__rtcl_wpnonce,file_path:e};t.ajax({type:"POST",url:rtcl.ajaxurl,data:r,success:function(t){console.log(t)},error:function(t,e){console.log(e)}})}(e.data.path)},error:function(t,e){console.log(e)}})})),t.fn.validate&&(t(".post-type-rtcl_listing #post").validate(),t(".post-type-rtcl_pricing #post").validate()),t("#send-email-to-user").on("click",(function(e){e.preventDefault();var r=t('<div style="display:none;" id="user-message"><div class="form-group"><textarea class="rtcl-form-control" rows="6"></textarea></div><a class="message-send button button-primary button-large">'+rtcl.i18n_send+"</a></div>").appendTo("body");return r.dialog({close:function(t,e){r.remove()},dialogClass:"rtcl-user-message-dialog",closeText:!1,modal:!0,width:400,maxWidth:850,zIndex:9999,maxHeight:.9*t(window).height(),title:rtcl.i18n_message,position:{my:"center top+50",at:"center top",of:window}}),r.on("click","a.message-send",(function(e){e.preventDefault();var i=t(this),n=t("#post_ID").val(),a=r.find("textarea").val();if(n&&a){var c={action:"rtcl_send_email_to_user_by_moderator",post_id:n,message:a,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({type:"POST",url:rtcl.ajaxurl,data:c,beforeSend:function(){t(".rtcl-flash-messages").remove(),i.addClass("disabled").attr("disabled","disabled"),t('<span class="rtcl-icon-spinner animate-spin"></span>').insertAfter(i)},success:function(e){i.removeClass("disabled"),t(".rtcl-icon-spinner",r).remove();var n=t("<div class='rtcl-flash-messages'>"+e.message+"</div>");n.insertAfter(i),n.addClass(e.class),e.error?i.removeAttr("disabled"):setTimeout((function(){r.dialog("close")}),1e3)},error:function(e,n){t(".rtcl-icon-spinner",r).remove(),r.dialog("close"),i.removeAttr("disabled"),0===e.status?alert("Not connect.\n Verify Network."):404==e.status?alert("Requested page not found. [404]"):500==e.status?alert("Internal Server Error [500]."):"parsererror"===n?alert("Requested JSON parse failed."):"timeout"===n?alert("Time out error."):"abort"===n?alert("Ajax request aborted."):alert("Uncaught Error.\n"+e.responseText)}})}else alert("Please add some message!!");return!1})),!1})),window.rtclInitDateField=function(){t.fn.daterangepicker&&t(".rtcl-date").each((function(){var e=t(this),r=e.data("options")||{};e.daterangepicker(r),!1===r.autoUpdateInput&&e.on("apply.daterangepicker",(function(e,r){t(this).val(r.startDate.format(r.locale.format))}))}))},t((function(){t("#rtcl-overwrite").on("change",(function(){t(".rtcl-overwrite-item").find("input");this.checked?t(".rtcl-overwrite-item").each((function(){t(this).data("id");var e=t(this).find("input"),r=t(".rtcl-overwrite-sub-item_"+t(this).data("id"));e.prop("disabled",!1),e.is(":checked")?r.find("input").prop("disabled",!1):r.find("input").prop("disabled",!0)})):t(".rtcl-overwrite-item").each((function(){t(this).data("id");var e=t(this).find("input"),r=t(".rtcl-overwrite-sub-item_"+t(this).data("id"));e.prop("disabled",!0),r.find("input").prop("disabled",!0)}))})),t(".rtcl-overwrite-item input").on("change",(function(){var e=t(this).attr("name"),r=t(".rtcl-overwrite-sub-item_"+e);t(this).is(":checked")?r.find("input").prop("disabled",!1):r.find("input").prop("disabled",!0)})),rtclInitDateField(),t.fn.select2&&(t(".rtcl-select2").select2({dropdownAutoWidth:!0,width:"100%"}),t.fn.select2&&(t(".rtcl-select2").select2({dropdownAutoWidth:!0,width:"100%"}),t(".rtcl-ajax-select").each((function(){var e={allowClear:!!t(this).data("allow_clear"),placeholder:t(this).data("placeholder")||"",minimumInputLength:t(this).data("minimum_input_length")?t(this).data("minimum_input_length"):"1",escapeMarkup:function(t){return t},ajax:{url:rtcl.ajaxurl,type:"POST",dataType:"json",delay:1e3,data:function(e){return{term:e.term,type:t(this).data("type")||"",action:t(this).data("action")||"rtcl_json_search_taxonomy",__rtcl_wpnonce:rtcl.__rtcl_wpnonce}},processResults:function(e){var r=[];return e&&t.each(e,(function(t,e){r.push({id:e.id,text:e.text||e.label})})),{results:r}},cache:!0}};if(t(this).select2(e).addClass("enhanced"),t(this).data("sortable")){var r=t(this),i=t(this).next(".select2-container").find("ul.select2-selection__rendered");i.sortable({placeholder:"ui-state-highlight select2-selection__choice",forcePlaceholderSize:!0,items:"li:not(.select2-search__field)",tolerance:"pointer",stop:function(){t(i.find(".select2-selection__choice").get().reverse()).each((function(){var e=t(this).data("data").id,i=r.find('option[value="'+e+'"]')[0];r.prepend(i)}))}})}})))),t("#expiry-date").length&&t("#expiry-date").datetimepicker(),t("#rtcl-location").on("change",(function(){var r=t(this),i={action:"rtcl_get_sub_location_options",term_id:t(this).val(),blank:!0,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({url:ajaxurl,data:i,type:"POST",beforeSend:function(){t(e).insertAfter(r)},success:function(e){r.next(".rtcl-spinner").remove(),t("#rtcl-sub-location").html(e.locations),t("#rtcl-sub-sub-location").html("").addClass("rtcl-hide"),e.locations?t("#sub-location-row").removeClass("rtcl-hide"):t("#sub-location-row").addClass("rtcl-hide")},error:function(){r.next(".rtcl-spinner").remove()}})})),t("#rtcl-sub-location").on("change",(function(){var r=t(this),i={action:"rtcl_get_sub_location_options",term_id:t(this).val(),blank:!0,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({url:ajaxurl,data:i,type:"POST",beforeSend:function(){t(e).insertAfter(r)},success:function(e){r.next(".rtcl-spinner").remove(),t("#rtcl-sub-sub-location").html(e.locations),e.locations?t("#sub-sub-location-row").removeClass("rtcl-hide"):t("#sub-sub-location-row").addClass("rtcl-hide")},error:function(){r.next(".rtcl-spinner").remove()}})})),t("body").hasClass("post-type-rtcl_listing")&&function(){if(void 0===window.wp.autosave)return;var e={post_title:t("#title").val()||"",content:t("#content").val()||"",excerpt:t("#excerpt").val()||""},r=window.wp.autosave.getCompareString(e);window.wp.autosave.server.postChanged=function(){var i=!1;return window.tinymce?(window.tinymce.each(["content","excerpt"],(function(r){var n=window.tinymce.get(r);if(!n||n.isHidden()){if((t("#"+r).val()||"")!==e[r])return i=!0,!1}else if(n.isDirty())return i=!0,!1})),(t("#title").val()||"")!==e.post_title&&(i=!0),i):window.wp.autosave.getCompareString()!==r}}()}))}(jQuery),function(t){var e;function r(){t(".ui-dialog").each((function(){t(this).css({maxWidth:"100%",zIndex:9999,top:t(window).scrollTop()+50+"px",left:(t("body").innerWidth()-t(this).outerWidth())/2+"px"})}))}t(document).on("dialogopen",".ui-dialog",(function(e,r){t("button.button-primary, button.wpcf-ui-dialog-cancel").blur().addClass("button").removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only")})),t(window).on("resize scroll",(function(){clearTimeout(e),e=setTimeout(r,200)})),{init:function(){t("#rtcl-order-notes").on("click","button.add-note",this.add_order_note).on("click","a.delete_note",this.delete_order_note)},add_order_note:function(){var e=t("textarea#rtcl-add-payment-note");if(e.val()){t("#rtcl-order-notes").rtclBlock();var r={action:"rtcl_add_order_note",post_id:parseInt(t("#post_ID").val(),10)||0,note:e.val(),note_type:t("select#rtcl-order-note-type").val(),__rtcl_wpnonce:rtcl.__rtcl_wpnonce};return t.post(rtcl.ajaxurl,r,(function(e){t("ul.rtcl_payment_notes").prepend(e.html),t("#rtcl-order-notes").rtclUnblock(),t("#rtcl-add-payment-note").val("")})),!1}},delete_order_note:function(){if(window.confirm(rtcl.i18n_delete_note)){var e=t(this).closest("li.note");t(e).rtclBlock();var r={action:"rtcl_delete_order_note",note_id:t(e).attr("rel"),__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({url:rtcl.ajaxurl,data:r,type:"POST",dataType:"json",beforeSend:function(){},success:function(r){r.success&&t(e).remove()}})}return!1}}.init()}(jQuery);
